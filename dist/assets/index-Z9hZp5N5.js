import{invoke as n}from"./core-DhEqZVGG.js";import{g as R,P as c,a as A,S as d,b as h,W as v}from"./window-DgZLKhRJ.js";import{listen as g,once as m,emit as O,emitTo as D,TauriEvent as b}from"./event-DjZVAIBO.js";function k(){return new y(R(),window.__TAURI_INTERNALS__.metadata.currentWebview.label,{skip:!0})}async function _(){return n("plugin:webview|get_all_webviews").then(i=>i.map(e=>new y(new v(e.windowLabel,{skip:!0}),e.label,{skip:!0})))}const p=["tauri://created","tauri://error"];class y{constructor(e,t,r){this.window=e,this.label=t,this.listeners=Object.create(null),r!=null&&r.skip||n("plugin:webview|create_webview",{windowLabel:e.label,options:{...r,label:t}}).then(async()=>this.emit("tauri://created")).catch(async s=>this.emit("tauri://error",s))}static async getByLabel(e){var t;return(t=(await _()).find(r=>r.label===e))!==null&&t!==void 0?t:null}static getCurrent(){return k()}static async getAll(){return _()}async listen(e,t){return this._handleTauriEvent(e,t)?()=>{const r=this.listeners[e];r.splice(r.indexOf(t),1)}:g(e,t,{target:{kind:"Webview",label:this.label}})}async once(e,t){return this._handleTauriEvent(e,t)?()=>{const r=this.listeners[e];r.splice(r.indexOf(t),1)}:m(e,t,{target:{kind:"Webview",label:this.label}})}async emit(e,t){if(p.includes(e)){for(const r of this.listeners[e]||[])r({event:e,id:-1,payload:t});return}return O(e,t)}async emitTo(e,t,r){if(p.includes(t)){for(const s of this.listeners[t]||[])s({event:t,id:-1,payload:r});return}return D(e,t,r)}_handleTauriEvent(e,t){return p.includes(e)?(e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t],!0):!1}async position(){return n("plugin:webview|webview_position",{label:this.label}).then(e=>new c(e))}async size(){return n("plugin:webview|webview_size",{label:this.label}).then(e=>new A(e))}async close(){return n("plugin:webview|webview_close",{label:this.label})}async setSize(e){return n("plugin:webview|set_webview_size",{label:this.label,value:e instanceof d?e:new d(e)})}async setPosition(e){return n("plugin:webview|set_webview_position",{label:this.label,value:e instanceof h?e:new h(e)})}async setFocus(){return n("plugin:webview|set_webview_focus",{label:this.label})}async setAutoResize(e){return n("plugin:webview|set_webview_auto_resize",{label:this.label,value:e})}async hide(){return n("plugin:webview|webview_hide",{label:this.label})}async show(){return n("plugin:webview|webview_show",{label:this.label})}async setZoom(e){return n("plugin:webview|set_webview_zoom",{label:this.label,value:e})}async reparent(e){return n("plugin:webview|reparent",{label:this.label,window:typeof e=="string"?e:e.label})}async clearAllBrowsingData(){return n("plugin:webview|clear_all_browsing_data")}async setBackgroundColor(e){return n("plugin:webview|set_webview_background_color",{color:e})}async onDragDropEvent(e){const t=await this.listen(b.DRAG_ENTER,l=>{e({...l,payload:{type:"enter",paths:l.payload.paths,position:new c(l.payload.position)}})}),r=await this.listen(b.DRAG_OVER,l=>{e({...l,payload:{type:"over",position:new c(l.payload.position)}})}),s=await this.listen(b.DRAG_DROP,l=>{e({...l,payload:{type:"drop",paths:l.payload.paths,position:new c(l.payload.position)}})}),E=await this.listen(b.DRAG_LEAVE,l=>{e({...l,payload:{type:"leave"}})});return()=>{t(),s(),r(),E()}}}function u(){const i=k();return new w(i.label,{skip:!0})}async function f(){return n("plugin:window|get_all_windows").then(i=>i.map(e=>new w(e,{skip:!0})))}class w{constructor(e,t={}){var r;this.label=e,this.listeners=Object.create(null),t!=null&&t.skip||n("plugin:webview|create_webview_window",{options:{...t,parent:typeof t.parent=="string"?t.parent:(r=t.parent)===null||r===void 0?void 0:r.label,label:e}}).then(async()=>this.emit("tauri://created")).catch(async s=>this.emit("tauri://error",s))}static async getByLabel(e){var t;const r=(t=(await f()).find(s=>s.label===e))!==null&&t!==void 0?t:null;return r?new w(r.label,{skip:!0}):null}static getCurrent(){return u()}static async getAll(){return f()}async listen(e,t){return this._handleTauriEvent(e,t)?()=>{const r=this.listeners[e];r.splice(r.indexOf(t),1)}:g(e,t,{target:{kind:"WebviewWindow",label:this.label}})}async once(e,t){return this._handleTauriEvent(e,t)?()=>{const r=this.listeners[e];r.splice(r.indexOf(t),1)}:m(e,t,{target:{kind:"WebviewWindow",label:this.label}})}async setBackgroundColor(e){return n("plugin:window|set_background_color",{color:e}).then(()=>n("plugin:webview|set_webview_background_color",{color:e}))}}T(w,[v,y]);function T(i,e){(Array.isArray(e)?e:[e]).forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(r=>{var s;typeof i.prototype=="object"&&i.prototype&&r in i.prototype||Object.defineProperty(i.prototype,r,(s=Object.getOwnPropertyDescriptor(t.prototype,r))!==null&&s!==void 0?s:Object.create(null))})})}let a=null;async function z(){if(a)try{const i=u();await n("reposition_traffic_lights",{window:i,offsetX:a.offsetX??0,offsetY:a.offsetY??0})}catch(i){console.error("Failed to reposition traffic lights:",i)}}async function S(i){try{a=i||{};const e=u();await n("enable_rounded_corners",{window:e,offsetX:(i==null?void 0:i.offsetX)??0,offsetY:(i==null?void 0:i.offsetY)??0}),W()}catch(e){throw console.error("Failed to enable rounded corners:",e),e}}async function X(i){try{a=i||{};const e=u();await n("enable_modern_window_style",{window:e,cornerRadius:(i==null?void 0:i.cornerRadius)??12,offsetX:(i==null?void 0:i.offsetX)??0,offsetY:(i==null?void 0:i.offsetY)??0}),W()}catch(e){throw console.error("Failed to enable modern window style:",e),e}}let o=null;async function W(){o&&o();const i=u();try{o=await i.onResized(()=>{z()})}catch(e){console.error("Failed to setup resize listener:",e)}}function Y(){o&&(o(),o=null),a=null}export{Y as cleanupRoundedCorners,X as enableModernWindowStyle,S as enableRoundedCorners,z as repositionTrafficLights};
